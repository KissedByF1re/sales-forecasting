# Прогнозирование временных рядов продаж

Данный проект реализует различные подходы к прогнозированию продаж на основе временных рядов с использованием как классических статистических моделей (ARIMA, SARIMA, ETS), так и современного метода машинного обучения (CatBoost).

## Задания проекта

### 1. Прогнозирование с помощью классических методов (`classical_models_forecasting.ipynb`)

В рамках первого задания реализован класс `ClassicalForecaster`, который:
- Выполняет предобработку исходных данных в формат, удобный для анализа временных рядов
- Реализует обучение и прогнозирование с помощью классических статистических моделей:
  - ARIMA (Авторегрессионное интегрированное скользящее среднее)
  - SARIMA (Сезонное ARIMA)
  - ETS (Экспоненциальное сглаживание)
- Оценивает качество прогнозов с использованием метрик MAE, RMSE, MAPE, R²
- Визуализирует результаты прогнозирования для различных горизонтов (неделя, месяц, квартал)
- Предоставляет функционал автоматического поиска оптимальной модели для каждого временного ряда

### 2. Прогнозирование с помощью современных методов (`catboost_forecasting.ipynb`)

Во втором задании реализован класс `CatBoostForecaster`, который:
- Предобрабатывает данные с учетом специфики методов машинного обучения
- Реализует прогнозирование с использованием модели градиентного бустинга (CatBoost)
- Выполняет подбор гиперпараметров для оптимизации качества прогнозов
- Сравнивает качество прогнозов на различных временных горизонтах
- Визуализирует результаты и значимость признаков

### 3. Итоговый проект - инференс предобученных моделей (`inference_forecasting.ipynb`)

В итоговом проекте реализован класс `BestForecaster`, который:
- Интегрирует лучшие модели из предыдущих заданий
- Предоставляет функционал загрузки предобученных моделей из директории models/
- Выполняет прогнозирование на произвольных данных
- Обеспечивает прогнозирование на неделю, месяц и квартал
- Визуализирует результаты и оценивает качество прогнозов

## Используемые данные

Проект работает с данными о продажах товаров в розничных магазинах, включая:
- Временные ряды продаж по товарам (количество продаж, выручка) (файл shop_sales.csv)
- Информацию о ценах (файл shop_sales_prices.csv)
- Календарные данные с информацией о событиях и акциях (файл shop_sales_dates.csv)

## Результаты

Подробные результаты анализа, сравнения моделей и визуализации представлены в соответствующих Jupyter-ноутбуках:
- `classical_models_forecasting.ipynb` - Анализ и сравнение классических моделей
- `catboost_forecasting.ipynb` - Анализ и результаты градиентного бустинга
- `inference_forecasting.ipynb` - Инференс лучших моделей

## Структура проекта

```
time_series_forecasting/
├── data/                      # Данные о продажах по магазинам
├── forecasters/               # Реализации Python-классов для прогноза
│   ├── __init__.py
│   ├── classical_forecaster.py  # Классические модели (ARIMA, SARIMA, ETS)
│   ├── catboost_forecaster.py     # Современная модель (CatBoost)
│   └── best_forecaster.py       # Лучшая модель (CatBoost)
├── models/                      # Предобученные модели CatBoost
├── classical_models_forecasting.ipynb  # Прогнозирование классическими моделями
├── catboost_forecasting.ipynb          # Прогнозирование современными моделями
├── inference_forecasting.ipynb         # Инференс предобученных моделей
├── README.md                           # Описание проекта
└── requirements.txt                    # Зависимости проекта
```

## Зависимости проекта

Для установки необходимых зависимостей используйте:
```
pip install -r requirements.txt
```

## Автор

Розанов Константин
tg - @kbf02

